<!DOCTYPE html>
<html>
  <head>
    <script src="static/js/d3.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <title>Billionares, State Fragillity, and Global Devolpment</title>

    <style>
      body { font: 12px Arial;}

      #line_graph_development path {
      stroke: steelblue;
      stroke-width: 2;
      fill: none;
      }

      #line_graph_development {
      display: inline-block;
      }

      #line_graph_fragility {
      display: inline-block;
      }

      #line_graph_development .axis path,
      #line_graph_development .axis line {
      fill: none;
      stroke: grey;
      stroke-width: 1;
      shape-rendering: crispEdges;
      }

      #line_graph_fragility path {
      stroke: steelblue;
      stroke-width: 2;
      fill: none;
      }

      #line_graph_fragility .axis path,
      #line_graph_fragility .axis line {
      fill: none;
      stroke: grey;
      stroke-width: 1;
      shape-rendering: crispEdges;
      }

      .chart div {
      font: 10px sans-serif;
      background-color: steelblue;
      text-align: right;
      padding: 3px;
      margin: 1px;
      color: white;
      }

      .slate {
      border: thick solid black;
      }
    </style>

  </head>

  <body>
    <center>
      <h1>Billionares, State Fragillity, and Global Devolpment</h1>
    </center>
    <br>

    <center>
      <h2>Where are the World's Billionares</h2>
    </center>

    <center>

      <!--   <div id="regions_div" style="width: 900px; height: 500px;"></div> -->

      Global Development
      <div id="geochart-colors" style="width: 500px; height: 433px;"></div><br><br>
      State Fragility
      <div id="geochart-fragility" style="width: 500px; height: 433px;"></div>

      <!--   <div id="chart_div" style="width: 900px; height: 500px;"></div>
	     2	     <canvas class="slate" width="500" height="500" id="state_frag">
	     </canvas>

      <canvas class="slate" width="500" height="500" id="glob_dev">
      </canvas>
      -->
    </center>


    <br>
    <br>
    <hr>

    <!-- ==========================
	 These are the line graphs
         ========================== -->
    <center>
      <h2>Track Devolpment and Stabillty Globally</h2>

      <form action="/" method="POST">
	Choose a Country:<br/>
	<select name="country">
	  <option value="default">Country</option>
	  {% for country in countries %}
	  <option value="{{ country }}">{{ country }}</option>
	  {% endfor %}
	</select>
	<input type="submit">
      </form>

      <h3>Note: The scale on the y-axes changes dynamically based on the country<br/>
	You may also see that the y-axis may show negative numbers. This is because<br/>
	the global development graph is based on urban population percent growth.<br/>
	There may be a negative percent growth.<br/>
      </h3>
      <div id="line_graph_development"></div>
      <div id="line_graph_fragility"></div>
    </center>

    <center>
      <h5>Bar Graphs</h5>
      THERE WOULD BE SOME D3 BAR GRAPHS HERE
    </center>

    <!--
	<script>
	  google.charts.load('current', {'packages':['geochart']});
	  google.charts.setOnLoadCallback(drawRegionsMap);

	  function drawRegionsMap() {

	  var data = google.visualization.arrayToDataTable([
          ['Country', 'Popularity'],
          ['Germany', 200],
          ['United States', 300],
          ['Brazil', 400],
          ['Canada', 500],
          ['France', 600],
          ['RU', 700]
	  ]);

	  var options = {};

	  var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

	  chart.draw(data, options);
	  }
	</script>
	-->

    <script>

      google.charts.load('current', {'packages':['geochart']});
      google.charts.setOnLoadCallback(drawRegionsMap);

      <!-- google.charts.setOnLoadCallback(drawMarkersMap); -->


      function drawRegionsMap() {
      var data = google.visualization.arrayToDataTable([
      ['Country',   'Latitude'],
      {% for gd in gd_list %} {{gd | safe}}, {% endfor %}

      ]);


      var datas = google.visualization.arrayToDataTable([
      //    ['City',   'Population', 'Area'],
      ['Country', 'Latitude'],
      {% for sf in sf_list %} {{sf | safe}}, {% endfor %}

      ]);


      var option = {
      //region: '002', // Africa
      colorAxis: {colors: ['red', 'orange', 'yellow', 'green'] },
      backgroundColor: '#81d4fa',
      datalessRegionColor: 'white',
      defaultColor: '#f5f5f5',
      //    options['datamode'] = 'markers';
      };
      /*
      var options = {
      region: 'IT',
      displayMode: 'markers',
      colorAxis: {colors: ['green', 'blue']}
      };

      */
      var chart = new google.visualization.GeoChart(document.getElementById('geochart-colors'));
      chart.draw(data, option);

      var chart2 = new google.visualization.GeoChart(document.getElementById('geochart-fragility'));
      chart2.draw(datas, option);
      //  chart.draw(datas, options);
      };



      //put in list of numbers here
      var info_leg = [2016, 2017];
      var info_rev = [2.99, 3.21];
      var info_spend = [3.54, 3.65];
      var info_sd = [552, 443];
      var info_sd_gdp = [3.3, 2.6];
      var info_gdp = [16.5, 17];
      var info_fd_gdp= [105.2, 104.4];
      var info_fd= [17.4, 17.7];
      var colors = ['#43a2ca', '#f03b20'];

      var makeBars = function(graph, unit, info) {
      var dyn = d3.select(graph);
      dyn.selectAll("div")
      .data(info)
      .enter()
      .append("div")
      .style("width", function(d) {
      return d  + "px";
      })
      .style("background-color", function(d) {
      if (d==info[0]) {
      return colors[2];
      }
      else {
      return colors[1];
      }
      })
      .text( function(d) {
      return d + " " + unit;
      });
      };
      var transitionTest = function( graph, scale, info ) {
      var dyn = d3.select(graph);
      dyn.selectAll("div")
      .data(info)
      .transition()
      .duration(2000)
      .style("width", function(d) {
      return d * scale + "px";
      });
      };

      var mkleg = function(){
      var dyn = d3.select('#legend');
      dyn.selectAll("div").style("width", function(d){
      return "26px";
      });
      };

      //put in graph info in id#, unit of price, and name of list format

      makeBars('#legend',"",info_leg);
      mkleg();

      makeBars('#rev', "trillion", info_rev);
      transitionTest('#rev', 100, info_rev);

      makeBars('#spend', "trillion", info_spend);
      transitionTest('#spend', 100, info_spend);

      makeBars('#sd', "billion", info_sd);
      transitionTest('#sd', 1.5, info_sd);
      makeBars('#sd_gdp', "%", info_sd_gdp);
      transitionTest('#sd_gdp', 100, info_sd_gdp);

      makeBars('#gdp', "Trillion", info_gdp);
      transitionTest('#gdp', 35, info_gdp);

      makeBars('#fd_gdp', 'Percent', info_fd_gdp);
      transitionTest('#fd_gdp', 1.5, info_fd_gdp);
      makeBars('#fd', "Trillion", info_fd);
      transitionTest('#fd', 10, info_fd);
    </script>
    {% if line_graph_country != "default" %}
    <script>
      var country = "{{ line_graph_country }}";
    </script>
    <script src="static/js/line_graph_base.js"></script>
    <script src="static/js/line_graph_development.js"></script>
    <script src="static/js/line_graph_fragility.js"></script>
    {% endif %}
  </body>
</html>
